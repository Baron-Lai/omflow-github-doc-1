**程式碼元件**

**OMFLOW 使用手冊**

![](media/image1.jpeg){width="6.291666666666667in"
height="2.0729166666666665in"}

# 目錄 {#目錄 .unnumbered}

[目錄 [1](#目錄)](#目錄)

[通用備註 [2](#通用備註)](#通用備註)

[前言 [2](#前言)](#前言)

[1 表單 [2](#表單)](#表單)

[1.1 開單 [3](#開單)](#開單)

[1.2 推單 [4](#推單)](#推單)

[1.3 列表 [4](#列表)](#列表)

[1.4 刪單 [6](#刪單)](#刪單)

[1.5 進階推單 [6](#進階推單)](#進階推單)

[2 使用者 [8](#使用者)](#使用者)

[2.1 建立使用者1.1.6.0 [8](#建立使用者1.1.6.0)](#建立使用者1.1.6.0)

[2.2 更新使用者 [9](#更新使用者)](#更新使用者)

[2.3 查詢使用者(列表) [10](#查詢使用者列表)](#查詢使用者列表)

[2.4 查詢使用者(單一) [11](#查詢使用者單一)](#查詢使用者單一)

[2.5 查詢使用者Email(列表)
[12](#查詢使用者email列表)](#查詢使用者email列表)

[2.6 刪除使用者 [12](#刪除使用者)](#刪除使用者)

[2.7 使用者加入部門 [13](#使用者加入部門)](#使用者加入部門)

[2.8 使用者移出部門 [13](#使用者移出部門)](#使用者移出部門)

[3 部門/角色 [14](#部門角色)](#部門角色)

[3.1 建立部門 [14](#建立部門)](#建立部門)

[3.2 取得部門資訊 [15](#取得部門資訊)](#取得部門資訊)

[3.3 加入使用者 [16](#加入使用者)](#加入使用者)

[3.4 移出使用者 [16](#移出使用者)](#移出使用者)

[3.5 查詢部門職務權責 [17](#查詢部門職務權責)](#查詢部門職務權責)

[3.6 更新部門職務權責 [17](#更新部門職務權責)](#更新部門職務權責)

[4 組織圖 [18](#組織圖)](#組織圖)

[4.1 取得組織圖資訊 [18](#取得組織圖資訊)](#取得組織圖資訊)

[4.2 更新/新增組織圖 [20](#更新新增組織圖)](#更新新增組織圖)

[4.3 刪除組織圖 [21](#刪除組織圖)](#刪除組織圖)

[4.4 透過【同系職務/權責】尋找人員
[22](#透過同系職務權責尋找人員)](#透過同系職務權責尋找人員)

[4.5 透過【部門職務/權責】尋找人員
[23](#透過部門職務權責尋找人員)](#透過部門職務權責尋找人員)

# 通用備註 {#通用備註 .unnumbered}

1.  點擊：需要您進行滑鼠點擊的部分，會以粗體方式呈現

2.  變數：提到動態或非固定的文字項目時，會以［］作為提示，如［使用者名稱］

3.  元件：流程設計中每一個物件，通稱為元件

4.  欄位：一般指為可輸入的介面，本系統中也特指表單設計的可輸入欄位

5.  頁籤：介面或視窗上的分頁選項

6.  區塊：指多個欄位的集合，通常會有一個名稱於上方

# 前言 {#前言 .unnumbered}

位置：［**主選單**］＞**應用管理**＞**應用設計**＞［**任意應用**］＞［**任意流程**］＞**流程設計**頁籤
＞**程式碼**元件＞［**齒輪**］按鈕＞［Python］頁籤

此篇主要介紹使用者在設計「程式碼元件」時，可呼叫OMFLOW額外提供的內建function來進行資料查詢或變更，主要針對常用的使用者、部門、組織圖等等相關應用，以便簡化程式碼並確保系統穩定性。

# 表單

位置：［**主選單**］＞Apps＞［**任意應用**］＞［**任意流程**］＞［**任意表單**］

位置：［**主選單**］＞我的任務＞［**任意表單**］

「表單」的相關應用為OMFLOW的主要功能，在流程中也時常需要查詢其他表單資料作為後續參數資料使用。抑或是滿足條件後需要同時推動其他表單繼續按照流程前進，因此針對「表單」設計了以下function供呼叫：

## 開單

開立表單是最常見的功能，一般在OMFLOW介面上操作如下面位置：

位置：［**主選單**］＞**Apps**＞［**任意應用**］＞［**任意流程**］＞**新增**

位置：［**主選單**］＞**服務請求**＞［**任意服務請求**］＞填寫完**送出**

雖然流程設計已提供「外部流程、內部流程」元件進行開單動作，但以上元件會等待新開的流程結束才會回到原流程上繼續前進，如設計者需要在不等待新開的流程結束便直接前進，則需要用到此代碼：

## 推單

當表單流程行進「人工處理」元件時會停下，直到使用者手動或呼叫web
API對此表單進行「推單」動作才會繼續前進，一般在OMFLOW介面操作如下：

位置：［**主選單**］＞**Apps**＞［**任意應用**］＞［**任意流程**］＞［**任意表單**］＞**送出**

位置：［**主選單**］＞**我的任務**＞［**任意表單**］＞［**快速操作**］

除「手動、呼叫web
API」方式以外，也可以在流程行進過程中對特定表單進行「推單」，code代碼如下：

## 列表

當流程需要查詢特定的表單資料時，可使用code代碼如下：

位置：［**主選單**］＞**Apps**＞［**任意應用**］＞［**任意流程**］＞**篩選**

## 刪單

當表單流程過程中需要刪除特定表單時可使用code代碼，一般在OMFLOW介面操作如下：

位置：［**主選單**］＞**Apps**＞［**任意應用**］＞［**任意流程**］＞［**任意表單**］＞**刪除**

## 進階推單

此方法無須先取得表單data_id，而是透過「條件查詢」直接將取得的表單依照後續設定進行「推單」動作，使用code代碼如下：

# 使用者

位置：［**主選單**］＞**人員管理**＞**使用者管理**＞［**任意使用者**］

在流程中如需要「查詢使用者」資料或對使用者相關資料進行「新增、修改、刪除」動作，因此設計了以下function供呼叫：

## 建立使用者**1.1.6.0**

## 更新使用者

## 查詢使用者(列表)

## 查詢使用者(單一)

## 查詢使用者Email(列表)

## 刪除使用者

## 使用者加入部門

## 使用者移出部門

# 部門/角色

位置：［**主選單**］＞**人員管理**＞**部門管理**＞［**任意部門**］

位置：［**主選單**］＞**人員管理**＞**角色管理**＞［**任意角色**］

OMFLOW
1.1.6.0版本後，在流程中如需要查詢「部門、角色」資料或對其進行「新增、修改、刪除」動作，因此設計了以下function供呼叫：

## 建立部門

## 取得部門資訊

## 加入使用者

## 移出使用者

## 查詢部門職務權責

## 更新部門職務權責

# 組織圖

位置：［**主選單**］＞**人員管理**＞**組織圖**＞［**任意組織圖**］

OMFLOW
1.1.6.0版本後，在流程中如需要查詢「組織圖」資料或對其進行「新增、修改、刪除」動作，因此設計了以下function供呼叫：

## 取得組織圖資訊

OMFLOW版本 **1.1.6.3** 功能：

回傳資料範例如下所示：

## 更新/新增組織圖

## 刪除組織圖

注意要點：

I.  若要刪除託管圖，應更新主圖資訊解除託管，而非以此方法。

## 透過【同系職務/權責】尋找人員

OMFLOW版本 **1.1.6.3**
更動後，可輸入「使用者編號、職務/權責」並透過「組織圖、部門」查詢符合的使用者，此方法也可在程式碼元件使用，code代碼如下：

## 透過【部門職務/權責】尋找人員

OMFLOW版本 **1.1.6.3**
更動後，可輸入「部門代號、職務/權責」並透過「組織圖、部門」查詢符合的使用者，此方法也可在程式碼元件使用，code代碼如下：

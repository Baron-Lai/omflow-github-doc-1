<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=big5">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<title>簽核與組織</title>
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:新細明體;
	panose-1:2 2 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:"\@新細明體";
	panose-1:2 1 6 1 0 1 1 1 1 1;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
h1
	{mso-style-link:"標題 1 字元";
	margin-top:9.0pt;
	margin-right:0cm;
	margin-bottom:9.0pt;
	margin-left:0cm;
	line-height:300%;
	page-break-after:avoid;
	font-size:26.0pt;
	font-family:"Calibri Light",sans-serif;}
h2
	{mso-style-link:"標題 2 字元";
	margin:0cm;
	line-height:300%;
	page-break-after:avoid;
	font-size:24.0pt;
	font-family:"Calibri Light",sans-serif;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin-top:6.0pt;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	font-size:10.0pt;
	font-family:"Calibri",sans-serif;
	text-transform:uppercase;
	font-weight:bold;}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:12.0pt;
	font-size:10.0pt;
	font-family:"Calibri",sans-serif;
	font-variant:small-caps;}
a:link, span.MsoHyperlink
	{color:#0563C1;
	text-decoration:underline;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:24.0pt;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
span.1
	{mso-style-name:"標題 1 字元";
	mso-style-link:"標題 1";
	font-family:"Calibri Light",sans-serif;
	font-weight:bold;}
span.2
	{mso-style-name:"標題 2 字元";
	mso-style-link:"標題 2";
	font-family:"Calibri Light",sans-serif;
	font-weight:bold;}
.MsoChpDefault
	{font-family:"Calibri",sans-serif;}
 /* Page Definitions */
 @page WordSection1
	{size:595.3pt 841.9pt;
	margin:42.55pt 42.55pt 42.55pt 42.55pt;
	layout-grid:18.0pt;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>

</head>

<body lang=ZH-TW link="#0563C1" vlink="#954F72" style='word-wrap:break-word'>

<div class=WordSection1 style='layout-grid:18.0pt'>

<p class=MsoNormal><b><span style='font-size:48.0pt;font-family:"新細明體",serif'>程式碼元件</span></b></p>

<p class=MsoNormal><b><span lang=EN-US style='font-size:20.0pt;color:black'>OMFLOW
</span></b><b><span style='font-size:20.0pt;font-family:"新細明體",serif;
color:black'>使用手冊</span></b></p>

<p class=MsoNormal><img width=604 height=199
src="6-1_OMFLOW使用手冊_程式碼元件.files/image001.gif" align=left hspace=12
alt="文件版本：1.1.6.3&#13;&#10;文件產生日期：112/10/03&#13;&#10; &#13;&#10;"><span
lang=EN-US><br clear=all style='page-break-before:always'>
</span></p>

<h1 align=center style='text-align:center'><a name="_Toc146199795"></a><a
name="_Toc146199856"></a><a name="_Toc146203598"></a><a name="_Toc146355670"></a><a
name="_Toc147237156"></a><a name="_Toc147503806"><span style='font-family:"新細明體",serif'>目錄</span></a></h1>

<p class=MsoToc1><span
lang=EN-US><a href="#_Toc147503806"><span lang=EN-US style='font-family:"新細明體",serif'><span
lang=EN-US>目錄</span></span><span style='color:windowtext;display:none;
text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoToc1><span lang=EN-US><a href="#_Toc147503807"><span lang=EN-US
style='font-family:"新細明體",serif'><span lang=EN-US>通用備註</span></span><span
style='color:windowtext;display:none;text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>2</span></a></span></p>

<p class=MsoToc1><span lang=EN-US><a href="#_Toc147503808"><span lang=EN-US
style='font-family:"新細明體",serif'><span lang=EN-US>前言</span></span><span
style='color:windowtext;display:none;text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>2</span></a></span></p>

<p class=MsoToc1><span lang=EN-US><a href="#_Toc147503809">1<span
style='font-size:12.0pt;color:windowtext;text-transform:none;font-weight:normal;
text-decoration:none'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
lang=EN-US style='font-family:"新細明體",serif'><span lang=EN-US>表單</span></span><span
style='color:windowtext;display:none;text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>2</span></a></span></p>

<p class=MsoToc2><span lang=EN-US><a href="#_Toc147503810">1.1<span
style='font-size:12.0pt;font-variant:normal !important;color:windowtext;
text-decoration:none'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
lang=EN-US style='font-family:"新細明體",serif'><span lang=EN-US>開單</span></span><span
style='color:windowtext;display:none;text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>3</span></a></span></p>

<p class=MsoToc2><span lang=EN-US><a href="#_Toc147503811">1.2<span
style='font-size:12.0pt;font-variant:normal !important;color:windowtext;
text-decoration:none'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
lang=EN-US style='font-family:"新細明體",serif'><span lang=EN-US>推單</span></span><span
style='color:windowtext;display:none;text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>4</span></a></span></p>

<p class=MsoToc2><span lang=EN-US><a href="#_Toc147503812">1.3<span
style='font-size:12.0pt;font-variant:normal !important;color:windowtext;
text-decoration:none'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
lang=EN-US style='font-family:"新細明體",serif'><span lang=EN-US>列表</span></span><span
style='color:windowtext;display:none;text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>4</span></a></span></p>

<p class=MsoToc2><span lang=EN-US><a href="#_Toc147503813">1.4<span
style='font-size:12.0pt;font-variant:normal !important;color:windowtext;
text-decoration:none'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
lang=EN-US style='font-family:"新細明體",serif'><span lang=EN-US>刪單</span></span><span
style='color:windowtext;display:none;text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>6</span></a></span></p>

<p class=MsoToc2><span lang=EN-US><a href="#_Toc147503814">1.5<span
style='font-size:12.0pt;font-variant:normal !important;color:windowtext;
text-decoration:none'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
lang=EN-US style='font-family:"新細明體",serif'><span lang=EN-US>進階推單</span></span><span
style='color:windowtext;display:none;text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>6</span></a></span></p>

<p class=MsoToc1><span lang=EN-US><a href="#_Toc147503815">2<span
style='font-size:12.0pt;color:windowtext;text-transform:none;font-weight:normal;
text-decoration:none'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
lang=EN-US style='font-family:"新細明體",serif'><span lang=EN-US>使用者</span></span><span
style='color:windowtext;display:none;text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>8</span></a></span></p>

<p class=MsoToc2><span lang=EN-US><a href="#_Toc147503816">2.1<span
style='font-size:12.0pt;font-variant:normal !important;color:windowtext;
text-decoration:none'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
lang=EN-US style='font-family:"新細明體",serif'><span lang=EN-US>建立使用者</span></span>1.1.6.0<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>8</span></a></span></p>

<p class=MsoToc2><span lang=EN-US><a href="#_Toc147503817">2.2<span
style='font-size:12.0pt;font-variant:normal !important;color:windowtext;
text-decoration:none'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
lang=EN-US style='font-family:"新細明體",serif'><span lang=EN-US>更新使用者</span></span><span
style='color:windowtext;display:none;text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>9</span></a></span></p>

<p class=MsoToc2><span lang=EN-US><a href="#_Toc147503818">2.3<span
style='font-size:12.0pt;font-variant:normal !important;color:windowtext;
text-decoration:none'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
lang=EN-US style='font-family:"新細明體",serif'><span lang=EN-US>查詢使用者</span></span>(<span
lang=EN-US style='font-family:"新細明體",serif'><span lang=EN-US>列表</span></span>)<span
style='color:windowtext;display:none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>10</span></a></span></p>

<p class=MsoToc2><span lang=EN-US><a href="#_Toc147503819">2.4<span
style='font-size:12.0pt;font-variant:normal !important;color:windowtext;
text-decoration:none'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
lang=EN-US style='font-family:"新細明體",serif'><span lang=EN-US>查詢使用者</span></span>(<span
lang=EN-US style='font-family:"新細明體",serif'><span lang=EN-US>單一</span></span>)<span
style='color:windowtext;display:none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>11</span></a></span></p>

<p class=MsoToc2><span lang=EN-US><a href="#_Toc147503820">2.5<span
style='font-size:12.0pt;font-variant:normal !important;color:windowtext;
text-decoration:none'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
lang=EN-US style='font-family:"新細明體",serif'><span lang=EN-US>查詢使用者</span></span>Email(<span
lang=EN-US style='font-family:"新細明體",serif'><span lang=EN-US>列表</span></span>)<span
style='color:windowtext;display:none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>12</span></a></span></p>

<p class=MsoToc2><span lang=EN-US><a href="#_Toc147503821">2.6<span
style='font-size:12.0pt;font-variant:normal !important;color:windowtext;
text-decoration:none'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
lang=EN-US style='font-family:"新細明體",serif'><span lang=EN-US>刪除使用者</span></span><span
style='color:windowtext;display:none;text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>12</span></a></span></p>

<p class=MsoToc2><span lang=EN-US><a href="#_Toc147503822">2.7<span
style='font-size:12.0pt;font-variant:normal !important;color:windowtext;
text-decoration:none'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
lang=EN-US style='font-family:"新細明體",serif'><span lang=EN-US>使用者加入部門</span></span><span
style='color:windowtext;display:none;text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>13</span></a></span></p>

<p class=MsoToc2><span lang=EN-US><a href="#_Toc147503823">2.8<span
style='font-size:12.0pt;font-variant:normal !important;color:windowtext;
text-decoration:none'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
lang=EN-US style='font-family:"新細明體",serif'><span lang=EN-US>使用者移出部門</span></span><span
style='color:windowtext;display:none;text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>13</span></a></span></p>

<p class=MsoToc1><span lang=EN-US><a href="#_Toc147503824">3<span
style='font-size:12.0pt;color:windowtext;text-transform:none;font-weight:normal;
text-decoration:none'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
lang=EN-US style='font-family:"新細明體",serif'><span lang=EN-US>部門</span></span>/<span
lang=EN-US style='font-family:"新細明體",serif'><span lang=EN-US>角色</span></span><span
style='color:windowtext;display:none;text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>14</span></a></span></p>

<p class=MsoToc2><span lang=EN-US><a href="#_Toc147503825">3.1<span
style='font-size:12.0pt;font-variant:normal !important;color:windowtext;
text-decoration:none'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
lang=EN-US style='font-family:"新細明體",serif'><span lang=EN-US>建立部門</span></span><span
style='color:windowtext;display:none;text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>14</span></a></span></p>

<p class=MsoToc2><span lang=EN-US><a href="#_Toc147503826">3.2<span
style='font-size:12.0pt;font-variant:normal !important;color:windowtext;
text-decoration:none'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
lang=EN-US style='font-family:"新細明體",serif'><span lang=EN-US>取得部門資訊</span></span><span
style='color:windowtext;display:none;text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>15</span></a></span></p>

<p class=MsoToc2><span lang=EN-US><a href="#_Toc147503827">3.3<span
style='font-size:12.0pt;font-variant:normal !important;color:windowtext;
text-decoration:none'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
lang=EN-US style='font-family:"新細明體",serif'><span lang=EN-US>加入使用者</span></span><span
style='color:windowtext;display:none;text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>16</span></a></span></p>

<p class=MsoToc2><span lang=EN-US><a href="#_Toc147503828">3.4<span
style='font-size:12.0pt;font-variant:normal !important;color:windowtext;
text-decoration:none'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
lang=EN-US style='font-family:"新細明體",serif'><span lang=EN-US>移出使用者</span></span><span
style='color:windowtext;display:none;text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>16</span></a></span></p>

<p class=MsoToc2><span lang=EN-US><a href="#_Toc147503829">3.5<span
style='font-size:12.0pt;font-variant:normal !important;color:windowtext;
text-decoration:none'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
lang=EN-US style='font-family:"新細明體",serif'><span lang=EN-US>查詢部門職務權責</span></span><span
style='color:windowtext;display:none;text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>17</span></a></span></p>

<p class=MsoToc2><span lang=EN-US><a href="#_Toc147503830">3.6<span
style='font-size:12.0pt;font-variant:normal !important;color:windowtext;
text-decoration:none'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
lang=EN-US style='font-family:"新細明體",serif'><span lang=EN-US>更新部門職務權責</span></span><span
style='color:windowtext;display:none;text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>17</span></a></span></p>

<p class=MsoToc1><span lang=EN-US><a href="#_Toc147503831">4<span
style='font-size:12.0pt;color:windowtext;text-transform:none;font-weight:normal;
text-decoration:none'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
lang=EN-US style='font-family:"新細明體",serif'><span lang=EN-US>組織圖</span></span><span
style='color:windowtext;display:none;text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>18</span></a></span></p>

<p class=MsoToc2><span lang=EN-US><a href="#_Toc147503832">4.1<span
style='font-size:12.0pt;font-variant:normal !important;color:windowtext;
text-decoration:none'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
lang=EN-US style='font-family:"新細明體",serif'><span lang=EN-US>取得組織圖資訊</span></span><span
style='color:windowtext;display:none;text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>18</span></a></span></p>

<p class=MsoToc2><span lang=EN-US><a href="#_Toc147503833">4.2<span
style='font-size:12.0pt;font-variant:normal !important;color:windowtext;
text-decoration:none'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
lang=EN-US style='font-family:"新細明體",serif'><span lang=EN-US>更新</span></span>/<span
lang=EN-US style='font-family:"新細明體",serif'><span lang=EN-US>新增組織圖</span></span><span
style='color:windowtext;display:none;text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>20</span></a></span></p>

<p class=MsoToc2><span lang=EN-US><a href="#_Toc147503834">4.3<span
style='font-size:12.0pt;font-variant:normal !important;color:windowtext;
text-decoration:none'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
lang=EN-US style='font-family:"新細明體",serif'><span lang=EN-US>刪除組織圖</span></span><span
style='color:windowtext;display:none;text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>21</span></a></span></p>

<p class=MsoToc2><span lang=EN-US><a href="#_Toc147503835">4.4<span
style='font-size:12.0pt;font-variant:normal !important;color:windowtext;
text-decoration:none'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
lang=EN-US style='font-family:"新細明體",serif'><span lang=EN-US>透過【同系職務</span></span>/<span
lang=EN-US style='font-family:"新細明體",serif'><span lang=EN-US>權責】尋找人員</span></span><span
style='color:windowtext;display:none;text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>22</span></a></span></p>

<p class=MsoToc2><span lang=EN-US><a href="#_Toc147503836">4.5<span
style='font-size:12.0pt;font-variant:normal !important;color:windowtext;
text-decoration:none'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
lang=EN-US style='font-family:"新細明體",serif'><span lang=EN-US>透過【部門職務</span></span>/<span
lang=EN-US style='font-family:"新細明體",serif'><span lang=EN-US>權責】尋找人員</span></span><span
style='color:windowtext;display:none;text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>23</span></a></span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<span lang=EN-US style='font-size:12.0pt;font-family:"Calibri",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h1><a name="_Toc146199796"></a><a name="_Toc146199857"></a><a
name="_Toc146203599"></a><a name="_Toc146355671"></a><a name="_Toc147503807"><span
style='font-family:"新細明體",serif'>通用備註</span></a></h1>

<p class=MsoListParagraph style='margin-left:24.0pt;text-indent:-24.0pt'><span
lang=EN-US>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"新細明體",serif'>點擊：需要您進行滑鼠點擊的部分，會以粗體方式呈現</span></p>

<p class=MsoListParagraph style='margin-left:24.0pt;text-indent:-24.0pt'><span
lang=EN-US>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"新細明體",serif'>變數：提到動態或非固定的文字項目時，會以&#65339;&#65341;作為提示，如&#65339;使用者名稱&#65341;</span></p>

<p class=MsoListParagraph style='margin-left:24.0pt;text-indent:-24.0pt'><span
lang=EN-US>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"新細明體",serif'>元件：流程設計中每一個物件，通稱為元件</span>
</p>

<p class=MsoListParagraph style='margin-left:24.0pt;text-indent:-24.0pt'><span
lang=EN-US>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"新細明體",serif'>欄位：一般指為可輸入的介面，本系統中也特指表單設計的可輸入欄位</span></p>

<p class=MsoListParagraph style='margin-left:24.0pt;text-indent:-24.0pt'><span
lang=EN-US>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"新細明體",serif'>頁籤：介面或視窗上的分頁選項</span></p>

<p class=MsoListParagraph style='margin-left:24.0pt;text-indent:-24.0pt'><span
lang=EN-US>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"新細明體",serif'>區塊：指多個欄位的集合，通常會有一個名稱於上方</span></p>

<h1><a name="_Toc147237157"></a><a name="_Toc147503808"><span style='font-family:
"新細明體",serif'>前言</span></a></h1>

<p class=MsoNormal style='text-indent:.05pt'><a name="_Toc146199797"></a><a
name="_Toc146199858"></a><a name="_Toc146203600"><span style='font-family:"新細明體",serif;
color:black;background:#D9D9D9'>位置：</span></a><span style='font-family:"新細明體",serif;
color:black;background:#D9D9D9'>&#65339;<b>主</b></span><b><span style='font-family:
"新細明體",serif;color:black;background:#D9D9D9'>選單</span></b><span
style='font-family:"新細明體",serif;color:black;background:#D9D9D9'>&#65341;＞<b>應用管理</b>＞<b>應用設計</b>＞&#65339;<b>任意應用</b>&#65341;＞&#65339;<b>任意流程</b>&#65341;＞<b>流程設計</b>頁籤</span><span
lang=EN-US style='color:black;background:#D9D9D9'>&nbsp;&nbsp;&nbsp; </span><span
style='font-family:"新細明體",serif;color:black;background:#D9D9D9'>＞<b>程式碼</b>元件＞&#65339;<b>齒輪</b>&#65341;按鈕＞&#65339;</span><span
lang=EN-US style='color:black;background:#D9D9D9'>Python</span><span
style='font-family:"新細明體",serif;color:black;background:#D9D9D9'>&#65341;頁籤</span></p>

<p class=MsoListParagraph style='margin-top:9.0pt;margin-right:0cm;margin-bottom:
9.0pt;margin-left:0cm'><span style='font-family:"新細明體",serif'>此篇主要介紹使用者在設計「程式碼元件」時，可呼叫</span><span
lang=EN-US>OMFLOW</span><span style='font-family:"新細明體",serif'>額外提供的內建</span><span
lang=EN-US>function</span><span style='font-family:"新細明體",serif'>來進行資料查詢或變更，主要針對常用的使用者、部門、組織圖等等相關應用，以便簡化程式碼並確保系統穩定性。</span></p>

<h1 style='margin-left:21.25pt;text-indent:-21.25pt'><a name="_Toc147503809"><span
lang=EN-US style='font-family:"Calibri",sans-serif'>1<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"新細明體",serif'>表單</span></a></h1>

<p class=MsoListParagraph style='margin-left:21.25pt'><span style='font-family:
"新細明體",serif;color:black;background:#D9D9D9'>位置：</span><span style='font-family:
"新細明體",serif;color:black;background:#D9D9D9'>&#65339;<b>主</b></span><b><span
style='font-family:"新細明體",serif;color:black;background:#D9D9D9'>選單</span></b><span
style='font-family:"新細明體",serif;color:black;background:#D9D9D9'>&#65341;＞</span><span
lang=EN-US style='color:black;background:#D9D9D9'>Apps</span><span
style='font-family:"新細明體",serif;color:black;background:#D9D9D9'>＞&#65339;<b>任意應用</b>&#65341;＞&#65339;<b>任意流程</b>&#65341;＞&#65339;<b>任意表單</b>&#65341;</span></p>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span style='font-family:"新細明體",serif;color:black;
background:#D9D9D9'>位置：</span><span style='font-family:"新細明體",serif;color:black;
background:#D9D9D9'>&#65339;<b>主</b></span><b><span style='font-family:"新細明體",serif;
color:black;background:#D9D9D9'>選單</span></b><span style='font-family:"新細明體",serif;
color:black;background:#D9D9D9'>&#65341;＞我的任務＞&#65339;<b>任意表單</b>&#65341;</span></p>

<p class=MsoListParagraph style='margin-top:9.0pt;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span style='font-family:"新細明體",serif'>「表單」的相關應用為</span><span
lang=EN-US>OMFLOW</span><span style='font-family:"新細明體",serif'>的主要功能，在流程中也時常需要查詢其他表單資料作為後續參數資料使用。抑或是滿足條件後需要同時推動其他表單繼續按照流程前進，因此針對「表單」設計了以下</span><span
lang=EN-US>function</span><span style='font-family:"新細明體",serif'>供呼叫：</span></p>

<span lang=EN-US style='font-size:12.0pt;font-family:"Calibri",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><b><span lang=EN-US style='font-size:24.0pt'>&nbsp;</span></b></p>

<h2 style='margin-left:49.6pt;text-indent:-1.0cm'><a name="_Toc147503810"><span
lang=EN-US style='font-family:"Calibri",sans-serif'>1.1<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"新細明體",serif'>開單</span></a></h2>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span style='font-family:"新細明體",serif'>開立表單是最常見的功能，一般在</span><span
lang=EN-US>OMFLOW</span><span style='font-family:"新細明體",serif'>介面上操作如下面位置：</span></p>

<p class=MsoListParagraph style='margin-left:21.25pt'><span style='font-family:
"新細明體",serif;color:black;background:#D9D9D9'>位置：</span><span style='font-family:
"新細明體",serif;color:black;background:#D9D9D9'>&#65339;<b>主選單</b>&#65341;＞</span><b><span
lang=EN-US style='color:black;background:#D9D9D9'>Apps</span></b><span
style='font-family:"新細明體",serif;color:black;background:#D9D9D9'>＞&#65339;<b>任意應用</b>&#65341;＞&#65339;<b>任意流程</b>&#65341;＞<b>新增</b></span></p>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span style='font-family:"新細明體",serif;color:black;
background:#D9D9D9'>位置：</span><span style='font-family:"新細明體",serif;color:black;
background:#D9D9D9'>&#65339;<b>主</b></span><b><span style='font-family:"新細明體",serif;
color:black;background:#D9D9D9'>選單</span></b><span style='font-family:"新細明體",serif;
color:black;background:#D9D9D9'>&#65341;＞<b>服務請求</b>＞&#65339;<b>任意服務請求</b>&#65341;＞填寫完<b>送出</b></span></p>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span style='font-family:"新細明體",serif'>雖然流程設計已提供「外部流程、內部流程」元件進行開單動作，但以上元件會等待新開的流程結束才會回到原流程上繼續前進，如設計者需要在不等待新開的流程結束便直接前進，則需要用到此代碼：</span></p>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span lang=EN-US><img width=613 height=611
src="6-1_OMFLOW使用手冊_程式碼元件.files/image002.gif"
alt="#匯入&#13;&#10;from omflow.syscom.tools import OmData&#13;&#10;&#13;&#10;#宣告一個流程的物件&#13;&#10;api_path = 'incident-managment'&#13;&#10;inc_flow_obj = OmData(api_path)&#13;&#10;&#13;&#10;#填入表單資料(非必要，視流程需求)&#13;&#10;inc_flow_obj.setFormData('formitm_1', 'Apache服務異常')&#13;&#10;inc_flow_obj.setFormData('formitm_2', 'red')&#13;&#10;inc_flow_obj.setFormData('formitm_3', '1')&#13;&#10;&#13;&#10;#填入流程變數(非必要，視流程需求)&#13;&#10;inc_flow_obj.setFlowVariable('message', 'success')&#13;&#10;inc_flow_obj.setFlowVariable('password', '1234567')&#13;&#10;&#13;&#10;#送出開單&#13;&#10;user_id = '1'   					#使用者編號&#13;&#10;files = None    					#檔案&#13;&#10;result = inc_flow_obj.create(user_id, files)&#13;&#10;&#13;&#10;#取得回傳&#13;&#10;data_no = result['data_no']    		#單號&#13;&#10;status = result['status']      		#狀態True/False&#13;&#10;message = result['message']    	#錯誤訊息，開單成功則為空字串&#13;&#10;"></span></p>

<span lang=EN-US style='font-size:12.0pt;font-family:"Calibri",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><b><span lang=EN-US style='font-size:24.0pt'>&nbsp;</span></b></p>

<h2 style='margin-left:49.6pt;text-indent:-1.0cm'><a name="_Toc147503811"><span
lang=EN-US style='font-family:"Calibri",sans-serif'>1.2<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"新細明體",serif'>推單</span></a></h2>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span style='font-family:"新細明體",serif'>當表單流程行進「</span><span
style='font-family:"新細明體",serif'>人工處理」元件時會停下，直到使用者手動或呼叫</span><span lang=EN-US>web
API</span><span style='font-family:"新細明體",serif'>對此表單進行「推單」動作才會繼續前進，一般在</span><span
lang=EN-US>OMFLOW</span><span style='font-family:"新細明體",serif'>介面操作如下：</span></p>

<p class=MsoListParagraph style='margin-left:21.25pt'><span style='font-family:
"新細明體",serif;color:black;background:#D9D9D9'>位置：</span><span style='font-family:
"新細明體",serif;color:black;background:#D9D9D9'>&#65339;<b>主</b></span><b><span
style='font-family:"新細明體",serif;color:black;background:#D9D9D9'>選單</span></b><span
style='font-family:"新細明體",serif;color:black;background:#D9D9D9'>&#65341;＞</span><b><span
lang=EN-US style='color:black;background:#D9D9D9'>Apps</span></b><span
style='font-family:"新細明體",serif;color:black;background:#D9D9D9'>＞&#65339;<b>任意應用</b>&#65341;＞&#65339;<b>任意流程</b>&#65341;＞&#65339;<b>任意表單</b>&#65341;＞<b>送出</b></span></p>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span style='font-family:"新細明體",serif;color:black;
background:#D9D9D9'>位置：</span><span style='font-family:"新細明體",serif;color:black;
background:#D9D9D9'>&#65339;<b>主</b></span><b><span style='font-family:"新細明體",serif;
color:black;background:#D9D9D9'>選單</span></b><span style='font-family:"新細明體",serif;
color:black;background:#D9D9D9'>&#65341;＞<b>我的任務</b>＞&#65339;<b>任意表單</b>&#65341;＞&#65339;<b>快速操作</b>&#65341;</span></p>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span style='font-family:"新細明體",serif'>除「手動、呼叫</span><span
lang=EN-US>web API</span><span style='font-family:"新細明體",serif'>」方式以外，也可以在流程行進過程中對特定表單進行「推單」，</span><span
lang=EN-US>code</span><span style='font-family:"新細明體",serif'>代碼如下：</span></p>

<p class=MsoListParagraph style='margin-left:21.25pt'><span lang=EN-US><img
width=613 height=491 src="6-1_OMFLOW使用手冊_程式碼元件.files/image003.gif"
alt="#匯入&#13;&#10;from omflow.syscom.tools import OmData&#13;&#10;#宣告一個流程的物件&#13;&#10;api_path = 'incident-managment'&#13;&#10;inc_flow_obj = OmData(api_path)&#13;&#10;#填入表單資料(非必要，視流程需求)&#13;&#10;inc_flow_obj.setFormData('formitm_1', 'Apache服務異常')&#13;&#10;inc_flow_obj.setFormData('formitm_2', 'red')&#13;&#10;inc_flow_obj.setFormData('formitm_3', '1')&#13;&#10;&#13;&#10;#推單&#13;&#10;data_id = '345' 				#資料編號(可透過列表取得)&#13;&#10;user_id = '1' 					#使用者編號&#13;&#10;files = None 					#檔案&#13;&#10;result = inc_flow_obj.update(data_id, user_id, files)&#13;&#10;&#13;&#10;#取得回傳&#13;&#10;data_no = result['data_no'] 		#單號&#13;&#10;status = result['status']			#狀態True/False&#13;&#10;message = result['message'] 		#錯誤訊息，推單成功則為空字串&#13;&#10;"></span></p>

<h2 style='margin-left:49.6pt;text-indent:-1.0cm'><a name="_Toc147503812"><span
lang=EN-US style='line-height:300%;font-family:"Calibri",sans-serif'>1.3<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='line-height:300%;font-family:"新細明體",serif'>列表</span></a></h2>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span style='font-family:"新細明體",serif'>當流程需要查詢特定的表單資料時，可使用</span><span
lang=EN-US>code</span><span style='font-family:"新細明體",serif'>代碼如下：</span></p>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span style='font-family:"新細明體",serif;color:black;
background:#D9D9D9'>位置：</span><span style='font-family:"新細明體",serif;color:black;
background:#D9D9D9'>&#65339;<b>主</b></span><b><span style='font-family:"新細明體",serif;
color:black;background:#D9D9D9'>選單</span></b><span style='font-family:"新細明體",serif;
color:black;background:#D9D9D9'>&#65341;＞</span><b><span lang=EN-US style='color:black;
background:#D9D9D9'>Apps</span></b><span style='font-family:"新細明體",serif;
color:black;background:#D9D9D9'>＞&#65339;<b>任意應用</b>&#65341;＞&#65339;<b>任意流程</b>&#65341;＞<b>篩選</b></span></p>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span lang=EN-US><img width=613 height=995
src="6-1_OMFLOW使用手冊_程式碼元件.files/image004.gif"
alt="#匯入&#13;&#10;from omflow.syscom.tools import OmData&#13;&#10;#宣告一個流程的物件&#13;&#10;api_path = 'incident-managment'&#13;&#10;inc_flow_obj = OmData(api_path)&#13;&#10;#列表&#13;&#10;search_conditions = [&#13;&#10;{&#13;&#10;'column':'history',&#13;&#10;'condition':'=',&#13;&#10;'value':False&#13;&#10;}, #查詢條件，查詢非歷史資料&#13;&#10;{&#13;&#10;'column':'running',&#13;&#10;'condition':'=',&#13;&#10;'value':False&#13;&#10;}, #查詢條件，查詢非執行中資料&#13;&#10;{&#13;&#10;'column':'error',&#13;&#10;'condition':'=',&#13;&#10;'value':False&#13;&#10;}, #查詢條件，查詢非異常資料&#13;&#10;]&#13;&#10;search_columns = [&#13;&#10;'data_no',&#13;&#10;'formitm_1'&#13;&#10;] #取得欄位，取得單號以及欄位1&#13;&#10;exclude_conditions = [&#13;&#10;{&#13;&#10;'column':'closed',&#13;&#10;'condition':'=',&#13;&#10;'value':True&#13;&#10;}&#13;&#10;] #排除條件，排除已關單資料&#13;&#10;order_columns = ['-data_no'] 	#使用單號逆排序&#13;&#10;limit = 0 						#取得所有資料(若值給100代表取得前100筆資料)&#13;&#10;start = 0 						#從第1筆資料開始&#13;&#10;result = inc_flow_obj.list(search_conditions, search_columns, exclude_conditions, order_columns, limit, start)&#13;&#10;#取得回傳&#13;&#10;#回傳詳細範例請參閱 REST API介紹&gt;查詢表單&#13;&#10;"></span></p>

<h2 style='margin-left:49.6pt;text-indent:-1.0cm'><a name="_Toc147503813"><span
lang=EN-US style='font-family:"Calibri",sans-serif'>1.4<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"新細明體",serif'>刪單</span></a></h2>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span style='font-family:"新細明體",serif'>當表單流程過程中需要刪除特定表單時可使用</span><span
lang=EN-US>code</span><span style='font-family:"新細明體",serif'>代碼，一般在</span><span
lang=EN-US>OMFLOW</span><span style='font-family:"新細明體",serif'>介面操作如下：</span></p>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span style='font-family:"新細明體",serif;color:black;
background:#D9D9D9'>位置：</span><span style='font-family:"新細明體",serif;color:black;
background:#D9D9D9'>&#65339;<b>主</b></span><b><span style='font-family:"新細明體",serif;
color:black;background:#D9D9D9'>選單</span></b><span style='font-family:"新細明體",serif;
color:black;background:#D9D9D9'>&#65341;＞</span><b><span lang=EN-US style='color:black;
background:#D9D9D9'>Apps</span></b><span style='font-family:"新細明體",serif;
color:black;background:#D9D9D9'>＞&#65339;<b>任意應用</b>&#65341;＞&#65339;<b>任意流程</b>&#65341;＞&#65339;<b>任意表單</b>&#65341;＞<b>刪除</b></span></p>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span lang=EN-US><img width=613 height=347
src="6-1_OMFLOW使用手冊_程式碼元件.files/image005.gif"
alt="#匯入&#13;&#10;from omflow.syscom.tools import OmData&#13;&#10;&#13;&#10;#宣告一個流程的物件&#13;&#10;api_path = 'incident-managment'&#13;&#10;inc_flow_obj = OmData(api_path)&#13;&#10;&#13;&#10;#刪單&#13;&#10;data_no_list = [] #單號陣列&#13;&#10;result = inc_flow_obj.delete(data_no_list)&#13;&#10;&#13;&#10;#取得回傳&#13;&#10;status = result['status'] 		#狀態True/False&#13;&#10;message = result['message']	#錯誤訊息，推單成功則為空字&#13;&#10;"></span></p>

<h2 style='margin-left:49.6pt;text-indent:-1.0cm'><a name="_Toc147503814"><span
lang=EN-US style='font-family:"Calibri",sans-serif'>1.5<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"新細明體",serif'>進階推單</span></a></h2>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span style='font-family:"新細明體",serif'>此方法無須先取得表單</span><span
lang=EN-US>data_id</span><span style='font-family:"新細明體",serif'>，而是透過「條件查詢」直接將取得的表單依照後續設定進行「推單」動作，</span><span
style='font-family:"新細明體",serif'>使用</span><span lang=EN-US>code</span><span
style='font-family:"新細明體",serif'>代碼如下：</span></p>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span lang=EN-US><img width=613 height=299
src="6-1_OMFLOW使用手冊_程式碼元件.files/image006.gif"
alt="#匯入&#13;&#10;from omflow.syscom.tools import OmData&#13;&#10;&#13;&#10;#宣告一個流程的物件&#13;&#10;api_path = 'incident-managment'&#13;&#10;inc_flow_obj = OmData(api_path)&#13;&#10;&#13;&#10;#填入表單資料(非必要，視流程需求)&#13;&#10;inc_flow_obj.setFormData('formitm_1', 'Apache服務異常')&#13;&#10;inc_flow_obj.setFormData('formitm_2', 'red')&#13;&#10;inc_flow_obj.setFormData('formitm_3', '1')&#13;&#10;#接續以下&#13;&#10;"></span></p>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span lang=EN-US><img width=613 height=1019
src="6-1_OMFLOW使用手冊_程式碼元件.files/image007.gif"
alt="#推單&#13;&#10;condition = {} #查詢條件&#13;&#10;'''&#13;&#10;condition可接受兩種資料型態(list/dict)&#13;&#10;情境一、查詢 單號等於5 的單並推進&#13;&#10;list寫法：&#13;&#10;condition = []&#13;&#10;con = {'column':'data_no','condition':'=','value':5}&#13;&#10;condition.append(con)&#13;&#10;dict寫法：&#13;&#10;condition = {'data_no':5}&#13;&#10;情境二、查詢 單號大於5 的單並推進&#13;&#10;list寫法：&#13;&#10;condition = []&#13;&#10;con = {'column':'data_no','condition':'&gt;','value':5}&#13;&#10;condition.append(con)&#13;&#10;dict寫法：&#13;&#10;condition = {'data_no__gt':5}&#13;&#10;情境三、查詢 單號大於5且某個輸入欄位的值等於test 的單並推進&#13;&#10;list寫法：&#13;&#10;condition = []&#13;&#10;con1 = {'column':'data_no','condition':'&gt;','value':5}&#13;&#10;condition.append(con1)&#13;&#10;con2 = {'column':'formitm_1','condition':'=','value':'test'}&#13;&#10;condition.append(con2)&#13;&#10;dict寫法：&#13;&#10;condition = {'data_no__gt':5, 'formitm_1':'test'}&#13;&#10;'''&#13;&#10;user_id = '1' 			#使用者編號&#13;&#10;files = None			 	#檔案&#13;&#10;update_duplicate = False 	&#13;&#10;#當條件查詢回來的資料為複數筆時，是否將其全部推進。若否，則全部不推進並回傳失敗訊息。&#13;&#10;update_duplicate_interval = 0 	&#13;&#10;#當推進的資料為複數筆時，每一筆推進的間隔時間(秒)&#13;&#10;wait_time_max = 0		&#13;&#10;#當查詢回來的資料筆數為0時，要進行n次重新查詢，n次查詢都為0後回傳錯誤訊息。&#13;&#10;wait_time_seconds = 0			#每次重新查詢的間隔時間(秒)&#13;&#10;result = inc_flow_obj.advanced_update(condition, user_id, files, update_duplicate, update_duplicate_interval, wait_time_seconds, wait_time_max)&#13;&#10;#取得回傳&#13;&#10;status = result['status'] 			#狀態True/False&#13;&#10;message = result['message'] 		#回傳訊息。成功推單的data_id或是失敗訊息。&#13;&#10;"></span></p>

<h1 style='margin-left:21.25pt;text-indent:-21.25pt'><a name="_Toc147503815"><span
lang=EN-US style='font-family:"Calibri",sans-serif'>2<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"新細明體",serif'>使用者</span></a></h1>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span style='font-family:"新細明體",serif;color:black;
background:#D9D9D9'>位置：</span><span style='font-family:"新細明體",serif;color:black;
background:#D9D9D9'>&#65339;<b>主</b></span><b><span style='font-family:"新細明體",serif;
color:black;background:#D9D9D9'>選單</span></b><span style='font-family:"新細明體",serif;
color:black;background:#D9D9D9'>&#65341;＞<b>人員管理</b>＞<b>使用者管理</b>＞&#65339;<b>任意使用者</b>&#65341;</span></p>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span style='font-family:"新細明體",serif'>在流程中如需要「查詢使用者」資料或對使用者相關資料進行「新增、修改、刪除」動作，因此設計了以下</span><span
lang=EN-US>function</span><span style='font-family:"新細明體",serif'>供呼叫：</span></p>

<h2 style='margin-left:49.6pt;text-indent:-1.0cm'><a name="_Toc147503816"><strong><span
lang=EN-US style='font-family:"Calibri",sans-serif'>2.1<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></strong><span style='font-family:"新細明體",serif'>建立</span></a><span
style='line-height:300%;font-family:"新細明體",serif'>使用者</span><strong><span
lang=EN-US style='font-family:"Calibri",sans-serif;font-weight:normal'>1.1.6.0</span></strong></h2>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span lang=EN-US><img width=613 height=635
src="6-1_OMFLOW使用手冊_程式碼元件.files/image008.gif"
alt="#匯入&#13;&#10;from omflow.syscom.tools import User&#13;&#10;&#13;&#10;#宣告一個流程的物件&#13;&#10;user_obj = User()&#13;&#10;&#13;&#10;#填入使用者資料(必填)&#13;&#10;username = 'a12345'&#13;&#10;token = 'aA!123456'&#13;&#10;nick_name ='王小明'&#13;&#10;email = 'a12345@gmail.com'&#13;&#10;&#13;&#10;#填入使用者資料(選填)&#13;&#10;#有下列欄位可填&#13;&#10;#birthday, gender, phone1, phone2, company, default_group, ad_no, extension_no&#13;&#10;other_param_dict = {}&#13;&#10;other_param_dict['ad_no'] = '001234'&#13;&#10;other_param_dict['phone1'] = '0911111111'&#13;&#10;&#13;&#10;#建立使用者&#13;&#10;result = user_obj.create(username, token, nick_name, email, other_param_dict)&#13;&#10;&#13;&#10;#取得回傳&#13;&#10;user_id = result['user_id']		#使用者id&#13;&#10;status = result['status'] 			#狀態True/False&#13;&#10;message = result['message'] 		#錯誤訊息，開單成功則為空字串&#13;&#10;"></span></p>

<h2 style='margin-left:49.6pt;text-indent:-1.0cm'><a name="_Toc147503817"><span
lang=EN-US style='line-height:300%;font-family:"Calibri",sans-serif'>2.2<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"新細明體",serif'>更新</span></a><span
style='line-height:300%;font-family:"新細明體",serif'>使用者</span></h2>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span lang=EN-US><img width=613 height=539
src="6-1_OMFLOW使用手冊_程式碼元件.files/image009.gif"
alt="#匯入&#13;&#10;from omflow.syscom.tools import User&#13;&#10;&#13;&#10;#宣告一個流程的物件&#13;&#10;user_obj = User()&#13;&#10;&#13;&#10;#選擇要修改的使用者(必填，user_id與username二選一填入)&#13;&#10;user_id = None&#13;&#10;username = None&#13;&#10;&#13;&#10;#更改密碼(選填)&#13;&#10;token = 'aA!123456'&#13;&#10;&#13;&#10;#填入要更新的使用者欄位(選填)&#13;&#10;#有下列欄位可填&#13;&#10;#email, birthday, gender, phone1, phone2, company, default_group, ad_no, extension_no&#13;&#10;other_param_dict = {}&#13;&#10;other_param_dict['phone1'] = '0911111111'&#13;&#10;&#13;&#10;#更新使用者&#13;&#10;result = user_obj.update(user_id, username, token, other_param_dict)&#13;&#10;#若 result = 'success' 代表成功，失敗則會回傳錯誤訊息&#13;&#10;"></span></p>

<h2 style='margin-left:49.6pt;text-indent:-1.0cm'><a name="_Toc147503818"><span
lang=EN-US style='font-family:"Calibri",sans-serif'>2.3<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"新細明體",serif'>查詢</span></a><span
style='line-height:300%;font-family:"新細明體",serif'>使用者</span><span lang=EN-US
style='font-family:"Calibri",sans-serif'>(</span><span style='font-family:"新細明體",serif'>列表</span><span
lang=EN-US style='font-family:"Calibri",sans-serif'>)</span></h2>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span lang=EN-US><img width=613 height=827
src="6-1_OMFLOW使用手冊_程式碼元件.files/image010.gif"
alt="#匯入&#13;&#10;from omflow.syscom.tools import User&#13;&#10;&#13;&#10;#宣告一個流程的物件&#13;&#10;user_obj = User()&#13;&#10;&#13;&#10;#查詢條件(下為範例，請依照實際需求修改)&#13;&#10;search_conditions = [&#13;&#10;{&#13;&#10;'column':'gender',&#13;&#10;'condition':'=',&#13;&#10;'value':'female'&#13;&#10;}, #查詢條件，查詢女性使用者&#13;&#10;]&#13;&#10;search_columns = [&#13;&#10;'username',&#13;&#10;'email'&#13;&#10;] #取得欄位，取得帳號以及信箱&#13;&#10;exclude_conditions = [&#13;&#10;{&#13;&#10;'column':'is_active',&#13;&#10;'condition':'=',&#13;&#10;'value':False&#13;&#10;}&#13;&#10;] #排除條件，排除停用的使用者&#13;&#10;&#13;&#10;order_columns = ['-username'] 	#使用帳號逆排序&#13;&#10;limit = 0 					#取得所有資料(若值給100代表取得前100筆資料)&#13;&#10;start = 0 					#從第1筆資料開始&#13;&#10;&#13;&#10;#查詢使用者&#13;&#10;result = user_obj.list(search_conditions, search_columns, exclude_conditions, order_columns, limit, start)&#13;&#10;#取得回傳&#13;&#10;#回傳詳細範例請參閱 REST API介紹&gt;使用者&#13;&#10;"></span></p>

<h2 style='margin-left:49.6pt;text-indent:-1.0cm'><a name="_Toc147503819"><span
lang=EN-US style='line-height:300%;font-family:"Calibri",sans-serif'>2.4<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"新細明體",serif'>查詢</span></a><span
style='line-height:300%;font-family:"新細明體",serif'>使用者</span><span lang=EN-US
style='line-height:300%;font-family:"Calibri",sans-serif'>(</span><span
style='line-height:300%;font-family:"新細明體",serif'>單一</span><span lang=EN-US
style='line-height:300%;font-family:"Calibri",sans-serif'>)</span></h2>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span lang=EN-US><img width=613 height=755
src="6-1_OMFLOW使用手冊_程式碼元件.files/image011.gif"
alt="#匯入&#13;&#10;from omflow.syscom.tools import User&#13;&#10;&#13;&#10;#宣告一個流程的物件&#13;&#10;user_obj = User()&#13;&#10;&#13;&#10;#查詢條件(必填，下列三選一填入)&#13;&#10;user_id = None&#13;&#10;username = None&#13;&#10;nick_name = None&#13;&#10;&#13;&#10;#填入要查詢的使用者欄位&#13;&#10;#有下列欄位可填&#13;&#10;#id, username, nick_name, email, birthday, gender, phone1, phone2, company, default_group, ad_no, extension_no&#13;&#10;#若留空代表查詢全部欄位&#13;&#10;user_attr = []&#13;&#10;&#13;&#10;#查詢使用者&#13;&#10;result = user_obj.load(user_id, username, nick_name, user_attr)&#13;&#10;&#13;&#10;#取得回傳(請依照查詢的欄位取得資料)&#13;&#10;#result資料結構如下&#13;&#10;{&#13;&#10;'id':123,&#13;&#10;'username':'12312',&#13;&#10;'nick_name':'王小明',&#13;&#10;'email':'123@gamil.com', 	#上述欄位會依照user_attr變數不同而有所不同&#13;&#10;'groups':[], 			#groups與roles則是固定提供之回傳，與user_attr填入與否無關&#13;&#10;'roles':[], 			#groups回傳使用者所在部門id陣列, roles回傳使用者所在的角色id陣列&#13;&#10;}&#13;&#10;"></span></p>

<h2 style='margin-left:49.6pt;text-indent:-1.0cm'><a name="_Toc147503820"><span
lang=EN-US style='line-height:300%;font-family:"Calibri",sans-serif'>2.5<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='line-height:300%;font-family:"新細明體",serif'>查詢使用者</span></a><span
lang=EN-US style='line-height:300%;font-family:"Calibri",sans-serif'>Email(</span><span
style='line-height:300%;font-family:"新細明體",serif'>列表</span><span lang=EN-US
style='line-height:300%;font-family:"Calibri",sans-serif'>)</span></h2>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span lang=EN-US><img width=613 height=347
src="6-1_OMFLOW使用手冊_程式碼元件.files/image012.gif"
alt="#匯入&#13;&#10;from omflow.syscom.tools import User&#13;&#10;&#13;&#10;#宣告一個流程的物件&#13;&#10;user_obj = User()&#13;&#10;&#13;&#10;#填入要查詢的使用者id(陣列)&#13;&#10;user_id_list = []&#13;&#10;&#13;&#10;#查詢多位使用者email&#13;&#10;result = user_obj.listEmail(user_id_list)&#13;&#10;&#13;&#10;#result資料格式如下&#13;&#10;['aaa@gmail.com','bbb@gmail.com','ccc@gmail.com','ddd@gmail.com']&#13;&#10;"></span></p>

<h2 style='margin-left:49.6pt;text-indent:-1.0cm'><a name="_Toc147503821"><span
lang=EN-US style='line-height:300%;font-family:"Calibri",sans-serif'>2.6<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='line-height:300%;font-family:"新細明體",serif'>刪除使用者</span></a></h2>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span lang=EN-US><img width=613 height=299
src="6-1_OMFLOW使用手冊_程式碼元件.files/image013.gif"
alt="#匯入&#13;&#10;from omflow.syscom.tools import User&#13;&#10;&#13;&#10;#宣告一個流程的物件&#13;&#10;user_obj = User()&#13;&#10;&#13;&#10;#填入要查詢的使用者帳號(陣列)&#13;&#10;username_list = []&#13;&#10;&#13;&#10;#刪除使用者&#13;&#10;result = user_obj.delete(username_list)&#13;&#10;#result若等於空字串代表刪除成功，回傳任何文字訊息代表是錯誤訊息&#13;&#10;"></span></p>

<h2 style='margin-left:49.6pt;text-indent:-1.0cm'><a name="_Toc147503822"><span
lang=EN-US style='line-height:300%;font-family:"Calibri",sans-serif'>2.7<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='line-height:300%;font-family:"新細明體",serif'>使用者加入部門</span></a></h2>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span lang=EN-US><img width=613 height=395
src="6-1_OMFLOW使用手冊_程式碼元件.files/image014.gif"
alt="#匯入&#13;&#10;from omflow.syscom.tools import User&#13;&#10;&#13;&#10;#宣告一個流程的物件&#13;&#10;user_obj = User()&#13;&#10;&#13;&#10;#選擇使用者(必填)&#13;&#10;user_id = None&#13;&#10;&#13;&#10;#填入要加入的部門id陣列(必填)&#13;&#10;group_id_list = []&#13;&#10;&#13;&#10;#使用者加入部門&#13;&#10;result = user_obj.addtoGroup(user_id, group_id_list)&#13;&#10;&#13;&#10;#result為boolean，True代表成功，False代表失敗&#13;&#10;"></span></p>

<h2 style='margin-left:49.6pt;text-indent:-1.0cm'><a name="_Toc147503823"><span
lang=EN-US style='line-height:300%;font-family:"Calibri",sans-serif'>2.8<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='line-height:300%;font-family:"新細明體",serif'>使用者移出部門</span></a></h2>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span lang=EN-US><img width=613 height=395
src="6-1_OMFLOW使用手冊_程式碼元件.files/image015.gif"
alt="#匯入&#13;&#10;from omflow.syscom.tools import User&#13;&#10;&#13;&#10;#宣告一個流程的物件&#13;&#10;user_obj = User()&#13;&#10;&#13;&#10;#選擇使用者(必填)&#13;&#10;user_id = None&#13;&#10;&#13;&#10;#填入要移出的部門id陣列(必填)&#13;&#10;group_id_list = []&#13;&#10;&#13;&#10;#使用者移出部門&#13;&#10;result = user_obj.removefromGroup(user_id, group_id_list)&#13;&#10;&#13;&#10;#result為boolean，True代表成功，False代表失敗&#13;&#10;"></span></p>

<h1 style='margin-left:21.25pt;text-indent:-21.25pt'><a name="_Toc147503824"><span
lang=EN-US style='line-height:300%;font-family:"Calibri",sans-serif'>3<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='line-height:300%;font-family:"新細明體",serif'>部門</span></a><span
lang=EN-US style='line-height:300%;font-family:"Calibri",sans-serif'>/</span><span
style='line-height:300%;font-family:"新細明體",serif'>角色</span></h1>

<p class=MsoListParagraph style='margin-left:21.25pt'><span style='font-family:
"新細明體",serif;color:black;background:#D9D9D9'>位置：</span><span style='font-family:
"新細明體",serif;color:black;background:#D9D9D9'>&#65339;<b>主</b></span><b><span
style='font-family:"新細明體",serif;color:black;background:#D9D9D9'>選單</span></b><span
style='font-family:"新細明體",serif;color:black;background:#D9D9D9'>&#65341;＞<b>人員管理</b>＞<b>部門管理</b>＞&#65339;<b>任意部門</b>&#65341;</span></p>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span style='font-family:"新細明體",serif;color:black;
background:#D9D9D9'>位置：</span><span style='font-family:"新細明體",serif;color:black;
background:#D9D9D9'>&#65339;<b>主</b></span><b><span style='font-family:"新細明體",serif;
color:black;background:#D9D9D9'>選單</span></b><span style='font-family:"新細明體",serif;
color:black;background:#D9D9D9'>&#65341;＞<b>人員管理</b>＞<b>角色管理</b>＞&#65339;<b>任意角色</b>&#65341;</span></p>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span lang=EN-US>OMFLOW 1.1.6.0</span><span
style='font-family:"新細明體",serif'>版本後，在流程中如需要查詢「部門、角色」資料或對其進行「新增、修改、刪除」動作，因此設計了以下</span><span
lang=EN-US>function</span><span style='font-family:"新細明體",serif'>供呼叫：</span></p>

<h2 style='margin-left:49.6pt;text-indent:-1.0cm'><a name="_Toc147503825"><span
lang=EN-US style='line-height:300%;font-family:"Calibri",sans-serif'>3.1<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"新細明體",serif'>建立</span></a><span
style='line-height:300%;font-family:"新細明體",serif'>部門</span></h2>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span lang=EN-US><img width=613 height=587
src="6-1_OMFLOW使用手冊_程式碼元件.files/image016.gif"
alt="#匯入&#13;&#10;from omflow.syscom.tools import Group&#13;&#10;&#13;&#10;#宣告一個部門(角色)的物件&#13;&#10;group_obj = Group()&#13;&#10;&#13;&#10;#填入資料(必填)&#13;&#10;group_name = 'test' 	#部門名稱&#13;&#10;is_role = False 			#填入True為角色，False為部門&#13;&#10;&#13;&#10;#填入資料(選填)&#13;&#10;parent_group_id = None #父部門id，角色不可填&#13;&#10;description = '' 		#說明欄位&#13;&#10;group_no = '' 			#部門代號&#13;&#10;order = 0 				#部門排序，數字越小排序越靠前，請填入整數(可以為負)&#13;&#10;&#13;&#10;#建立部門&#13;&#10;result = group_obj.create(parent_group_id, group_name, description, group_no, is_role, order)&#13;&#10;&#13;&#10;#取得回傳&#13;&#10;group_id = result['group_id'] 		#部門/角色id&#13;&#10;status = result['status'] 			#狀態True/False&#13;&#10;message = result['message'] 		#錯誤訊息，開單成功則為空字串&#13;&#10;"></span></p>

<h2 style='margin-left:49.6pt;text-indent:-1.0cm'><a name="_Toc147503826"><span
lang=EN-US style='line-height:300%;font-family:"Calibri",sans-serif'>3.2<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='line-height:300%;font-family:"新細明體",serif'>取得部門資訊</span></a></h2>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span lang=EN-US><img width=613 height=587
src="6-1_OMFLOW使用手冊_程式碼元件.files/image017.gif"
alt="#匯入&#13;&#10;from omflow.syscom.tools import Group&#13;&#10;&#13;&#10;#宣告一個部門(角色)的物件&#13;&#10;group_id = ''&#13;&#10;group_no = ''&#13;&#10;group_name = ''&#13;&#10;&#13;&#10;#部門id/部門代號/部門名稱請三選一填入值&#13;&#10;group_obj = Group(group_id, group_no, group_name)&#13;&#10;&#13;&#10;#讀取部門資訊&#13;&#10;result = group_obj.load()&#13;&#10;&#13;&#10;#取得回傳&#13;&#10;group_id = result.get('id','') 						#部門id&#13;&#10;display_name = result.get('display_name','') 		#部門名稱&#13;&#10;parent_group_id = result.get('parent_group_id','') 	#父部門id&#13;&#10;description = result.get('description','') 				#說明&#13;&#10;group_no = result.get('group_no','')				#部門代號&#13;&#10;group_user_list = result.get('group_user_list','') 		#該部門底下有的使用者id&#13;&#10;permissions = result.get('permissions','') 			#該角色有的權限，查詢部門時回傳為空陣列&#13;&#10;order = result.get('order ','') 						#部門排序&#13;&#10;"></span></p>

<h2 style='margin-left:49.6pt;text-indent:-1.0cm'><a name="_Toc147503827"><span
lang=EN-US style='line-height:300%;font-family:"Calibri",sans-serif'>3.3<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='line-height:300%;font-family:"新細明體",serif'>加入使用者</span></a></h2>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span lang=EN-US><img width=613 height=395
src="6-1_OMFLOW使用手冊_程式碼元件.files/image018.gif"
alt="#匯入&#13;&#10;from omflow.syscom.tools import Group&#13;&#10;&#13;&#10;#宣告一個部門(角色)的物件&#13;&#10;group_id = ''&#13;&#10;group_no = ''&#13;&#10;group_name = ''&#13;&#10;&#13;&#10;#部門id/部門代號/部門名稱請三選一填入值&#13;&#10;group_obj = Group(group_id, group_no, group_name)&#13;&#10;&#13;&#10;#填入使用者id列表&#13;&#10;user_id_list = []&#13;&#10;&#13;&#10;#部門加入使用者，result為boolean，True代表成功，False代表失敗&#13;&#10;result = group_obj.addUsers(user_id_list)&#13;&#10;"></span></p>

<h2 style='margin-left:49.6pt;text-indent:-1.0cm'><a name="_Toc147503828"><span
lang=EN-US style='line-height:300%;font-family:"Calibri",sans-serif'>3.4<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='line-height:300%;font-family:"新細明體",serif'>移出使用者</span></a></h2>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span lang=EN-US><img width=613 height=395
src="6-1_OMFLOW使用手冊_程式碼元件.files/image019.gif"
alt="#匯入&#13;&#10;from omflow.syscom.tools import Group&#13;&#10;&#13;&#10;#宣告一個部門(角色)的物件&#13;&#10;group_id = ''&#13;&#10;group_no = ''&#13;&#10;group_name = ''&#13;&#10;&#13;&#10;#部門id/部門代號/部門名稱請三選一填入值&#13;&#10;group_obj = Group(group_id, group_no, group_name)&#13;&#10;&#13;&#10;#填入使用者id列表&#13;&#10;user_id_list = []&#13;&#10;&#13;&#10;#部門移出使用者，result為boolean，True代表成功，False代表失敗&#13;&#10;result = group_obj.removeUsers(user_id_list)&#13;&#10;"></span></p>

<h2 style='margin-left:49.6pt;text-indent:-1.0cm'><a name="_Toc147503829"><span
lang=EN-US style='line-height:300%;font-family:"Calibri",sans-serif'>3.5<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='line-height:300%;font-family:"新細明體",serif'>查詢部門職務權責</span></a></h2>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span lang=EN-US><img width=613 height=395
src="6-1_OMFLOW使用手冊_程式碼元件.files/image019.gif"
alt="#匯入&#13;&#10;from omflow.syscom.tools import Group&#13;&#10;&#13;&#10;#宣告一個部門(角色)的物件&#13;&#10;group_id = ''&#13;&#10;group_no = ''&#13;&#10;group_name = ''&#13;&#10;&#13;&#10;#部門id/部門代號/部門名稱請三選一填入值&#13;&#10;group_obj = Group(group_id, group_no, group_name)&#13;&#10;&#13;&#10;#填入使用者id列表&#13;&#10;user_id_list = []&#13;&#10;&#13;&#10;#部門移出使用者，result為boolean，True代表成功，False代表失敗&#13;&#10;result = group_obj.removeUsers(user_id_list)&#13;&#10;"></span></p>

<h2 style='margin-left:49.6pt;text-indent:-1.0cm'><a name="_Toc147503830"><span
lang=EN-US style='line-height:300%;font-family:"Calibri",sans-serif'>3.6<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='line-height:300%;font-family:"新細明體",serif'>更新部門職務權責</span></a></h2>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span lang=EN-US><img width=613 height=395
src="6-1_OMFLOW使用手冊_程式碼元件.files/image019.gif"
alt="#匯入&#13;&#10;from omflow.syscom.tools import Group&#13;&#10;&#13;&#10;#宣告一個部門(角色)的物件&#13;&#10;group_id = ''&#13;&#10;group_no = ''&#13;&#10;group_name = ''&#13;&#10;&#13;&#10;#部門id/部門代號/部門名稱請三選一填入值&#13;&#10;group_obj = Group(group_id, group_no, group_name)&#13;&#10;&#13;&#10;#填入使用者id列表&#13;&#10;user_id_list = []&#13;&#10;&#13;&#10;#部門移出使用者，result為boolean，True代表成功，False代表失敗&#13;&#10;result = group_obj.removeUsers(user_id_list)&#13;&#10;"></span></p>

<h1 style='margin-left:21.25pt;text-indent:-21.25pt'><a name="_Toc147503831"><span
lang=EN-US style='line-height:300%;font-family:"Calibri",sans-serif'>4<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='line-height:300%;font-family:"新細明體",serif'>組織圖</span></a></h1>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span style='font-family:"新細明體",serif;color:black;
background:#D9D9D9'>位置：</span><span style='font-family:"新細明體",serif;color:black;
background:#D9D9D9'>&#65339;<b>主</b></span><b><span style='font-family:"新細明體",serif;
color:black;background:#D9D9D9'>選單</span></b><span style='font-family:"新細明體",serif;
color:black;background:#D9D9D9'>&#65341;＞<b>人員管理</b>＞<b>組織圖</b>＞&#65339;<b>任意組織圖</b>&#65341;</span></p>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span lang=EN-US>OMFLOW 1.1.6.0</span><span
style='font-family:"新細明體",serif'>版本後，在流程中如需要查詢「組織圖」資料或對其進行「新增、修改、刪除」動作，因此設計了以下</span><span
lang=EN-US>function</span><span style='font-family:"新細明體",serif'>供呼叫：</span></p>

<h2 style='margin-left:49.6pt;text-indent:-1.0cm'><a name="_Toc147503832"><span
lang=EN-US style='line-height:300%;font-family:"Calibri",sans-serif'>4.1<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"新細明體",serif'>取得</span></a><span
style='line-height:300%;font-family:"新細明體",serif'>組織圖資訊</span></h2>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span lang=EN-US>OMFLOW</span><span
style='font-family:"新細明體",serif'>版本</span> <b><span lang=EN-US>1.1.6.3</span></b><span
lang=EN-US> </span><span style='font-family:"新細明體",serif'>功能：</span></p>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span lang=EN-US><img width=613 height=323
src="6-1_OMFLOW使用手冊_程式碼元件.files/image020.gif"
alt="#匯入&#13;&#10;from omflow.syscom.tools import OrgChart&#13;&#10;&#13;&#10;#宣告一個組織圖的物件&#13;&#10;org_name = ''&#13;&#10;org_config_id = ''&#13;&#10;&#13;&#10;#組織圖名稱/組織圖編號，請擇一填入值&#13;&#10;org_obj = OrgChart(org_name, org_config_id)&#13;&#10;&#13;&#10;#讀取組織圖資訊&#13;&#10;result = org_obj.load()&#13;&#10;result = group_obj.removeUsers(user_id_list)&#13;&#10;"></span></p>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span style='font-family:"新細明體",serif'>回傳資料範例如下所示：</span><span
lang=EN-US><img width=613 height=947
src="6-1_OMFLOW使用手冊_程式碼元件.files/image021.gif"
alt="{&#13;&#10;&quot;org_name&quot;: &lt;組織圖名稱&gt;,&#13;&#10;&quot;value&quot;: [{&#13;&#10;&quot;org_id&quot;: &lt;組織元件編號&gt;,&#13;&#10;&quot;group_no&quot;: &lt;組織元件代號&gt;,&#13;&#10;&quot;group_name&quot;: &lt;組織元件名稱&gt;,&#13;&#10;&quot;parent_group_no&quot;: &lt;父組織元件代號&gt;,&#13;&#10;&quot;order&quot;: &lt;組織元件排序&gt;,&#13;&#10;&quot;host_user&quot;: &lt;託管人&gt;, #使用者編號&#13;&#10;&quot;host&quot;: &lt;是否被託管&gt;, #True/False&#13;&#10;&quot;is_host&quot;: &lt;是否屬於託管組織&gt;, #True/False&#13;&#10;&quot;job_role&quot;: [{&#13;&#10;&quot;job_role_id&quot;: &lt;資料編號&gt;, &#13;&#10;&quot;position_id&quot;: &lt;職務編號&gt;,&#13;&#10;&quot;position_no&quot;: &lt;職務代號&gt;,&#13;&#10;&quot;position_name&quot;: &lt;職務名稱&gt;,&#13;&#10;&quot;user_id&quot;: &lt;使用者編號&gt;, &#13;&#10;&quot;nick_name&quot;: &lt;使用者顯示名稱&gt;,&#13;&#10;&quot;is_active&quot;: &lt;使用者是否啟用&gt;, #True/False&#13;&#10;&quot;responsibility&quot;: &lt;權責&gt;, &#13;&#10;&quot;data_index&quot;: &lt;排序&gt;&#13;&#10;}&#13;&#10;],&#13;&#10;&quot;sub_item&quot;: &lt;託管組織&gt;,&#13;&#10;&quot;parent_group_name&quot;: &lt;父組織元件名稱&gt;&#13;&#10;},........#依此類推&#13;&#10;],&#13;&#10;&quot;org_approver&quot;: {&#13;&#10;&quot;group&quot;: &lt;審核人部門編號&gt;,&#13;&#10;&quot;user&quot;: &lt;審核人使用者編號&gt;&#13;&#10;},&#13;&#10;&quot;is_search_dept&quot;: &lt;組織圖查詢不到時，查詢部門架構&gt;, #True/False&#13;&#10;&quot;is_sub&quot;: &lt;是否為託管的組織圖&gt;, #True/False&#13;&#10;&quot;parent_chart_name&quot;: &lt;主圖名稱&gt;,&#13;&#10;&quot;uid&quot;: &lt;uid&gt;,&#13;&#10;&quot;pending_status&quot;: &lt;託管組織圖是否為審核狀態&gt;, #True/False&#13;&#10;&quot;host_user&quot;: &lt;託管人&gt;,&#13;&#10;&quot;org_config_id&quot;: &lt;組織圖編號&gt;&#13;&#10;}&#13;&#10;"></span></p>

<h2 style='margin-left:49.6pt;text-indent:-1.0cm'><a name="_Toc147503833"><span
lang=EN-US style='line-height:300%;font-family:"Calibri",sans-serif'>4.2<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='line-height:300%;font-family:"新細明體",serif'>更新</span></a><span
lang=EN-US style='line-height:300%;font-family:"Calibri",sans-serif'>/</span><span
style='line-height:300%;font-family:"新細明體",serif'>新增組織圖</span></h2>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span lang=EN-US><img width=613 height=875
src="6-1_OMFLOW使用手冊_程式碼元件.files/image022.gif"
alt="from omflow.syscom.tools import OrgChart				#匯入&#13;&#10;org_obj = OrgChart()								#宣告一個組織圖的物件&#13;&#10;org_chart_dict = {&#13;&#10;'org_name': &lt;組織圖名稱&gt;,&#13;&#10;'value': [{&#13;&#10;'org_id': &lt;組織元件編號&gt;, 					#修改舊資料時填寫&#13;&#10;'group_no': &lt;組織元件代號&gt;,&#13;&#10;'group_name': &lt;組織元件名稱&gt;,&#13;&#10;'parent_group_no': &lt;父組織元件代號&gt;,&#13;&#10;'order': &lt;組織元件排序&gt;,&#13;&#10;'host_user': &lt;託管人&gt;, 						#使用者編號&#13;&#10;'host': &lt;是否被託管&gt;, #True/False&#13;&#10;'is_host': &lt;是否屬於託管組織&gt;, 				#True/False&#13;&#10;'job_role': [{&#13;&#10;'job_role_id': &lt;資料編號&gt;,					#修改舊資料時填寫&#13;&#10;'position_no': &lt;職務代號&gt;,&#13;&#10;'user_id': &lt;使用者編號&gt;, &#13;&#10;'responsibility': &lt;權責&gt;, &#13;&#10;'data_index': &lt;排序&gt;&#13;&#10;}]&#13;&#10;},........#依此類推&#13;&#10;],&#13;&#10;'org_approver': {&#13;&#10;'group': &lt;審核人部門編號&gt;,&#13;&#10;'user': &lt;審核人使用者編號&gt;&#13;&#10;},&#13;&#10;'is_search_dept': &lt;組織圖查詢不到時，查詢部門架構&gt;, 	#True/False&#13;&#10;'is_sub': &lt;是否為託管的組織圖&gt;, 					#True/False&#13;&#10;'uid': &lt;uid&gt;,&#13;&#10;'org_config_id': &lt;組織圖編號&gt; 						#修改舊資料時填寫&#13;&#10;}&#13;&#10;result = org_obj.update(org_chart_dict)					#更新/新增組織圖資訊&#13;&#10;#取得回傳&#13;&#10;status = result['status'] 								#狀態success/update error&#13;&#10;message = result['message'] 							#錯誤訊息，執行成功則為空字串&#13;&#10;op_result = result['result'] 							#執行結果，執行成功則為空字串&#13;&#10;"></span></p>

<h2 style='margin-left:49.6pt;text-indent:-1.0cm'><a name="_Toc147503834"><span
lang=EN-US style='line-height:300%;font-family:"Calibri",sans-serif'>4.3<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='line-height:300%;font-family:"新細明體",serif'>刪除組織圖</span></a></h2>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span lang=EN-US><img width=613 height=347
src="6-1_OMFLOW使用手冊_程式碼元件.files/image023.gif"
alt="#匯入&#13;&#10;from omflow.syscom.tools import OrgChart&#13;&#10;&#13;&#10;#宣告一個組織圖的物件&#13;&#10;org_obj = OrgChart()&#13;&#10;org_config_id_list = [&lt;組織圖編號&gt;,........] &#13;&#10;&#13;&#10;#刪除組織圖&#13;&#10;result = org_obj.delete(org_config_id_list )&#13;&#10;&#13;&#10;#取得回傳&#13;&#10;status = result['status'] 			#狀態success/delete error&#13;&#10;message = result['message'] 		#錯誤訊息，執行成功則為空字串&#13;&#10;op_result = result['result'] 		#執行結果，執行成功則為空字串&#13;&#10;"></span></p>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span style='font-family:"新細明體",serif'>注意要點：</span></p>

<p class=MsoListParagraph style='margin-left:49.65pt;text-indent:-24.0pt'><span
lang=EN-US>I.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"新細明體",serif'>若要刪除託管圖，應更新主圖資訊解除託管，而非以此方法。</span></p>

<span lang=EN-US style='font-size:12.0pt;font-family:"Calibri",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><b><span lang=EN-US style='font-size:24.0pt'>&nbsp;</span></b></p>

<h2 style='margin-left:49.6pt;text-indent:-1.0cm'><a name="_Toc147503835"><span
lang=EN-US style='line-height:300%;font-family:"Calibri",sans-serif'>4.4<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='line-height:300%;font-family:"新細明體",serif'>透過【同系職務</span></a><span
lang=EN-US style='line-height:300%;font-family:"Calibri",sans-serif'>/</span><span
style='line-height:300%;font-family:"新細明體",serif'>權責】尋找人員</span></h2>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span lang=EN-US>OMFLOW</span><span
style='font-family:"新細明體",serif'>版本</span> <b><span lang=EN-US>1.1.6.3</span></b><span
lang=EN-US> </span><span style='font-family:"新細明體",serif'>更動後，可輸入「使用者編號、職務</span><span
lang=EN-US>/</span><span style='font-family:"新細明體",serif'>權責」並透過「組織圖、部門」查詢符合的使用者，此方法也可在程式碼元件使用，</span><span
lang=EN-US>code</span><span style='font-family:"新細明體",serif'>代碼如下：</span></p>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span lang=EN-US><img width=613 height=683
src="6-1_OMFLOW使用手冊_程式碼元件.files/image024.gif"
alt="#匯入&#13;&#10;from omflow.syscom.tools import User&#13;&#10;&#13;&#10;#宣告一個流程的物件&#13;&#10;user_obj = User()&#13;&#10;&#13;&#10;#選擇使用者(必填)&#13;&#10;user_id = None&#13;&#10;&#13;&#10;#部門代號(選填)，指定要從哪個部門開始查詢，未填寫則從使用者的預設部門開始查詢&#13;&#10;group_no=None&#13;&#10;&#13;&#10;#填入要查詢對象的職務名稱或職務代號或權責名稱(必填，下列三選一填入)&#13;&#10;position_name = None&#13;&#10;position_no = None&#13;&#10;responsibilitie_name = None&#13;&#10;&#13;&#10;#選擇要從組織圖或部門架構查詢，如果dept_search是False，請填寫組織圖名稱&#13;&#10;dept_search=False&#13;&#10;org_name=''&#13;&#10;&#13;&#10;#查詢組織圖&#13;&#10;result = user_obj.getPosition(user_id, group_no, org_name, position_name, position_no, responsibilitie_name, dept_search)&#13;&#10;&#13;&#10;#取得回傳&#13;&#10;manager_user_id = result.get('user_id','')&#13;&#10;manager_group_id = result.get('group_id','')&#13;&#10;"></span></p>

<span lang=EN-US style='font-size:12.0pt;font-family:"Calibri",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><b><span lang=EN-US style='font-size:24.0pt'>&nbsp;</span></b></p>

<h2 style='margin-left:49.6pt;text-indent:-1.0cm'><a name="_Toc147503836"><span
lang=EN-US style='line-height:300%;font-family:"Calibri",sans-serif'>4.5<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='line-height:300%;font-family:"新細明體",serif'>透過【部門職務</span></a><span
lang=EN-US style='line-height:300%;font-family:"Calibri",sans-serif'>/</span><span
style='line-height:300%;font-family:"新細明體",serif'>權責】尋找人員</span></h2>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span lang=EN-US>OMFLOW</span><span
style='font-family:"新細明體",serif'>版本</span> <b><span lang=EN-US>1.1.6.3</span></b><span
lang=EN-US> </span><span style='font-family:"新細明體",serif'>更動後，可輸入「部門代號、職務</span><span
lang=EN-US>/</span><span style='font-family:"新細明體",serif'>權責」並透過「組織圖、部門」查詢符合的使用者，此方法也可在程式碼元件使用，</span><span
lang=EN-US>code</span><span style='font-family:"新細明體",serif'>代碼如下：</span></p>

<p class=MsoListParagraph style='margin-top:0cm;margin-right:0cm;margin-bottom:
9.0pt;margin-left:21.25pt'><span lang=EN-US><img width=613 height=659
src="6-1_OMFLOW使用手冊_程式碼元件.files/image025.gif"
alt="#匯入&#13;&#10;from omflow.syscom.tools import Group&#13;&#10;&#13;&#10;#宣告一個部門(角色)的物件&#13;&#10;group_id = ''&#13;&#10;group_no = ''&#13;&#10;group_name = ''&#13;&#10;&#13;&#10;#部門id/部門代號/部門名稱請三選一填入值&#13;&#10;group_obj = Group(group_id, group_no, group_name)&#13;&#10;&#13;&#10;#填入要查詢對象的職務名稱或職務代號或權責名稱(必填，下列三選一填入)&#13;&#10;position_name = None&#13;&#10;position_no = None&#13;&#10;responsibilitie_name = None&#13;&#10;&#13;&#10;#選擇要從組織圖或部門架構查詢，如果dept_search是False，請填寫組織圖名稱&#13;&#10;org_name=''&#13;&#10;dept_search=False&#13;&#10;&#13;&#10;#查詢組織圖&#13;&#10;result = group_obj.getPosition(org_name='', position_name=None, position_no=None, responsibilitie_name=None, dept_search=False)&#13;&#10;&#13;&#10;#取得回傳&#13;&#10;manager_user_id = result.get('user_id','')&#13;&#10;manager_group_id = result.get('group_id','')&#13;&#10;"></span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

</div>

</body>

</html>
